---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths({ paginate }) {
    const posts = (await getCollection('blog')).sort(
        (a, b) => b.data.publishedDate.valueOf() - a.data.publishedDate.valueOf()
    );
    return paginate(posts, { pageSize: 10 });
}

const { page } = Astro.props;
---

<Layout title="Blog Archive">
    <main class="max-w-4xl mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold mb-8">Blog Archive</h1>
        <div class="space-y-8">
            {page.data.map(post => (
                <article class="prose lg:prose-xl">
                    <h2 class="mb-2">
                        <a href={`/blog/${post.slug}`} class="text-2xl font-bold hover:text-blue-600">
                            {post.data.title}
                        </a>
                    </h2>
                    <time class="text-gray-600" datetime={post.data.publishedDate.toISOString()}>
                        {post.data.publishedDate.toLocaleDateString('en-US', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        })}
                    </time>
                    <p class="mt-2">{post.data.description}</p>
                </article>
            ))}
        </div>

        <nav class="mt-8 flex justify-between">
            {page.url.prev ? (
                <a href={page.url.prev} class="text-blue-600 hover:text-blue-800">
                    ← Previous Page
                </a>
            ) : <span></span>}
            
            {page.url.next ? (
                <a href={page.url.next} class="text-blue-600 hover:text-blue-800">
                    Next Page →
                </a>
            ) : <span></span>}
        </nav>
    </main>
</Layout>
